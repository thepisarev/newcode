<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ò–≥—Ä–∞ "–†–∞–¥—É–≥–∞" (–°–≤–µ—Ç–æ—Ñ–æ—Ä) - –ù–æ–≤—ã–π –∫–æ–¥ –ù–õ–ü</title>
    
    <!-- Telegram Web App API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--tg-theme-bg-color, linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%));
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }
        
        /* –î–ª—è Telegram —É–±–∏—Ä–∞–µ–º padding –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin-bottom: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        h1 {
            font-size: 32px;
            color: #1a202c;
            margin-bottom: 5px;
        }

        .subtitle {
            color: #718096;
            font-size: 14px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-start {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-pause {
            background: #f59e0b;
            color: white;
        }

        .btn-reset {
            background: #ef4444;
            color: white;
        }

        .btn-icon {
            background: #f3f4f6;
            color: #1a202c;
            padding: 12px 16px;
        }

        .game-area {
            background: #1a202c;
            border-radius: 20px;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .game-area:fullscreen {
            border-radius: 0;
            min-height: 100vh;
        }

        .game-area:-webkit-full-screen {
            border-radius: 0;
            min-height: 100vh;
        }

        .game-area:-moz-full-screen {
            border-radius: 0;
            min-height: 100vh;
        }

        .game-area:-ms-fullscreen {
            border-radius: 0;
            min-height: 100vh;
        }

        /* –¢–∞–π–º–µ—Ä –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .fullscreen-timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 32px;
            font-weight: bold;
            font-family: monospace;
            z-index: 99999;
            display: none;
            pointer-events: none;
        }

        /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–≥–¥–∞ –µ—Å—Ç—å –∫–ª–∞—Å—Å visible */
        .fullscreen-timer.visible {
            display: block;
        }

        .word-display {
            font-size: 120px;
            font-weight: bold;
            text-align: center;
            padding: 60px;
            position: absolute;
            white-space: nowrap;
        }

        .action-display {
            font-size: 80px;
            font-weight: bold;
            text-align: center;
            color: white;
            padding: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            border: 4px solid white;
            position: absolute;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 12px;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 14px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
        }

        .setting-group {
            margin-bottom: 25px;
        }

        .setting-group h3 {
            font-size: 18px;
            color: #1a202c;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .slider {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            min-width: 80px;
            text-align: right;
            font-weight: 600;
            color: #667eea;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            background: #f3f4f6;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
            flex: 1;
            font-weight: 500;
        }

        .level-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .level-easy { background: #d1fae5; color: #065f46; }
        .level-medium { background: #fef3c7; color: #92400e; }
        .level-hard { background: #fee2e2; color: #991b1b; }

        .info-section {
            line-height: 1.8;
        }

        .info-section h3 {
            margin-bottom: 15px;
            color: #1a202c;
        }

        .info-section ul {
            list-style-position: inside;
            color: #4b5563;
        }

        .info-section li {
            margin-bottom: 8px;
        }

        .info-section strong {
            color: #1a202c;
        }

        .color-demo {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .color-chip {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        .hidden {
            display: none;
        }

        .session-complete {
            text-align: center;
            padding: 40px;
        }

        .session-complete h2 {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }

        .session-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
            color: #718096;
        }

        .session-stat {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
        }

        .emoji {
            font-size: 32px;
        }
        
        /* –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ –≤ Telegram */
        body.telegram-app .telegram-hide {
            display: none !important;
        }

        .speed-presets {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .speed-preset {
            padding: 8px 16px;
            background: #f3f4f6;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .speed-preset:hover {
            background: #e5e7eb;
        }

        .speed-preset.active {
            background: #667eea;
            color: white;
            border-color: #5a67d8;
        }

        @media (max-width: 768px) {
            h1 { font-size: 24px; }
            .word-display { font-size: 80px; padding: 40px; }
            .action-display { font-size: 60px; padding: 40px; }
            .button-group { justify-content: center; }
            .timer { font-size: 36px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="card">
            <div class="header">
                <div>
                    <h1>üåà –ò–≥—Ä–∞ "–†–∞–¥—É–≥–∞" (–°–≤–µ—Ç–æ—Ñ–æ—Ä)</h1>
                    <p class="subtitle">–ù–æ–≤—ã–π –∫–æ–¥ –ù–õ–ü ‚Ä¢ –≠—Ñ—Ñ–µ–∫—Ç –°—Ç—Ä—É–ø–∞ ‚Ä¢ –í—ã—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</p>
                </div>
                <div class="button-group">
                    <button class="btn-icon" onclick="toggleInfo()">‚ÑπÔ∏è</button>
                    <button class="btn-icon" onclick="toggleStats()">üìä</button>
                    <button class="btn-icon" onclick="toggleSettings()">‚öôÔ∏è</button>
                    <button class="btn-icon telegram-hide" onclick="toggleFullscreen()" id="fullscreenBtn">‚õ∂</button>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div id="infoSection" class="card hidden">
            <div class="info-section">
                <h3>‚ÑπÔ∏è –ö–∞–∫ –∏–≥—Ä–∞—Ç—å –≤ "–†–∞–¥—É–≥—É"</h3>
                <ul>
                    <li><strong>1. –ü–æ—Å—Ç–∞–≤—å—Ç–µ —Ü–µ–ª—å</strong> ‚Äî —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –∂–µ–ª–∞–Ω–∏–µ –∏–ª–∏ –∑–∞–¥–∞—á—É –¥–ª—è –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏—è</li>
                    <li><strong>2. –ù–∞–∑—ã–≤–∞–π—Ç–µ –¶–í–ï–¢ —Ç–µ–∫—Å—Ç–∞</strong>, –∞ –Ω–µ —Å–∞–º–æ —Å–ª–æ–≤–æ!</li>
                    <li><strong>3. –≠—Ñ—Ñ–µ–∫—Ç –°—Ç—Ä—É–ø–∞:</strong> –ö–æ–≥–¥–∞ –≤–∏–¥–∏—Ç–µ "–ö–†–ê–°–ù–´–ô" –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ —Å–∏–Ω–∏–º ‚Äî –≥–æ–≤–æ—Ä–∏—Ç–µ "–°–ò–ù–ò–ô"</li>
                    <li><strong>4. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–µ–π—Å—Ç–≤–∏–π:</strong></li>
                    <li style="margin-left: 20px;">‚Ä¢ <strong>–•–õ–û–ü–ö–ò</strong> ‚Äî —Ö–ª–æ–ø–Ω–∏—Ç–µ –≤ –ª–∞–¥–æ—à–∏ 1-3 —Ä–∞–∑–∞</li>
                    <li style="margin-left: 20px;">‚Ä¢ <strong>–ü–†–´–ñ–ö–ò</strong> ‚Äî –ø–æ–¥–ø—Ä—ã–≥–Ω–∏—Ç–µ 1-3 —Ä–∞–∑–∞</li>
                    <li style="margin-left: 20px;">‚Ä¢ <strong>–í–°–Å –í–ú–ï–°–¢–ï</strong> ‚Äî —Ö–ª–æ–ø–∞–π—Ç–µ –∏ –ø—Ä—ã–≥–∞–π—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</li>
                    <li><strong>5. –°–∫–æ—Ä–æ—Å—Ç—å:</strong> –ß—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ (–¥—É–º–∞—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å—Å—è)</li>
                    <li><strong>6. –ù–µ –∑–ª–∏—Ç–µ—Å—å –Ω–∞ –æ—à–∏–±–∫–∏</strong> ‚Äî –æ–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –º–æ–∑–≥—É –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è</li>
                    <li><strong>7. –ü–æ—Å–ª–µ –∏–≥—Ä—ã</strong> ‚Äî —Å–Ω–æ–≤–∞ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Å–≤–æ–µ–π —Ü–µ–ª–∏ –∏ –ø—Ä–æ–∂–∏–≤–∏—Ç–µ –µ—ë</li>
                </ul>

                <h3 style="margin-top: 25px;">üé® –¶–≤–µ—Ç–∞ —Ä–∞–¥—É–≥–∏</h3>
                <div class="color-demo">
                    <div class="color-chip" style="background: #ff0000; color: white;">–ö—Ä–∞—Å–Ω—ã–π</div>
                    <div class="color-chip" style="background: #ff8800; color: white;">–û—Ä–∞–Ω–∂–µ–≤—ã–π</div>
                    <div class="color-chip" style="background: #ffff00; color: #333;">–ñ—ë–ª—Ç—ã–π</div>
                    <div class="color-chip" style="background: #00ff00; color: #333;">–ó–µ–ª—ë–Ω—ã–π</div>
                    <div class="color-chip" style="background: #00ffff; color: #333;">–ì–æ–ª—É–±–æ–π</div>
                    <div class="color-chip" style="background: #0000ff; color: white;">–°–∏–Ω–∏–π</div>
                    <div class="color-chip" style="background: #8800ff; color: white;">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</div>
                </div>

                <h3 style="margin-top: 25px;">üéØ –î–ª—è —á–µ–≥–æ —ç—Ç–∞ –∏–≥—Ä–∞?</h3>
                <ul>
                    <li>–í—Ö–æ–¥ –≤–æ –≤–Ω–µ—à–Ω–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å</li>
                    <li>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–±–æ–∏—Ö –ø–æ–ª—É—à–∞—Ä–∏–π –º–æ–∑–≥–∞</li>
                    <li>–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –æ—Ç –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏–∏ –∏ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∂–≤–∞—á–∫–∏</li>
                    <li>–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π –≤ –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ –±–µ–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</li>
                    <li>–†–∞–∑–≤–∏—Ç–∏–µ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–π –≥–∏–±–∫–æ—Å—Ç–∏</li>
                    <li>–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–µ—Å—Å–∞ —á–µ—Ä–µ–∑ –¥–≤–∏–∂–µ–Ω–∏—è</li>
                </ul>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settingsSection" class="card hidden">
            <div class="setting-group">
                <h3>‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã</h3>
                <div class="slider-container">
                    <input type="range" class="slider" id="durationSlider" min="5" max="20" value="10" step="1">
                    <span class="slider-value" id="durationValue">10 –º–∏–Ω</span>
                </div>
                <div class="speed-presets">
                    <button class="speed-preset" onclick="setDuration(5)">5 –º–∏–Ω</button>
                    <button class="speed-preset active" onclick="setDuration(10)">10 –º–∏–Ω</button>
                    <button class="speed-preset" onclick="setDuration(15)">15 –º–∏–Ω</button>
                    <button class="speed-preset" onclick="setDuration(20)">20 –º–∏–Ω</button>
                </div>
            </div>

            <div class="setting-group">
                <h3>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å —Å–º–µ–Ω—ã —Å–ª–æ–≤</h3>
                <div class="slider-container">
                    <input type="range" class="slider" id="speedSlider" min="500" max="3000" value="1500" step="100">
                    <span class="slider-value" id="speedValue">1.5 —Å–µ–∫</span>
                </div>
                <div class="speed-presets">
                    <button class="speed-preset" onclick="setSpeed(2000)">üêå –ú–µ–¥–ª–µ–Ω–Ω–æ</button>
                    <button class="speed-preset active" onclick="setSpeed(1500)">‚ö° –°—Ä–µ–¥–Ω–µ</button>
                    <button class="speed-preset" onclick="setSpeed(1000)">üöÄ –ë—ã—Å—Ç—Ä–æ</button>
                    <button class="speed-preset" onclick="setSpeed(700)">üí® –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ</button>
                </div>
            </div>

            <div class="setting-group">
                <h3>üéØ –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–¥–µ–π—Å—Ç–≤–∏—è)</h3>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="enableActions" checked onchange="updateSettings()">
                        <label for="enableActions">–í–∫–ª—é—á–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–µ–π—Å—Ç–≤–∏–π</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="actionClaps" checked onchange="updateSettings()">
                        <label for="actionClaps">–•–õ–û–ü–ö–ò</label>
                        <span class="level-badge level-easy">–õ–µ–≥–∫–æ</span>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="actionJumps" checked onchange="updateSettings()">
                        <label for="actionJumps">–ü–†–´–ñ–ö–ò</label>
                        <span class="level-badge level-easy">–õ–µ–≥–∫–æ</span>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="actionAll" onchange="updateSettings()">
                        <label for="actionAll">–í–°–Å –í–ú–ï–°–¢–ï</label>
                        <span class="level-badge level-medium">–°—Ä–µ–¥–Ω–µ</span>
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <h3>üé® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="randomPosition" checked onchange="updateSettings()">
                        <label for="randomPosition">–°–ª–æ–≤–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö —ç–∫—Ä–∞–Ω–∞</label>
                        <span class="level-badge level-medium">–°—Ä–µ–¥–Ω–µ</span>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="randomSize" checked onchange="updateSettings()">
                        <label for="randomSize">–°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤</label>
                        <span class="level-badge level-medium">–°—Ä–µ–¥–Ω–µ</span>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="extraColors" onchange="updateSettings()">
                        <label for="extraColors">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ (10 –≤–º–µ—Å—Ç–æ 7)</label>
                        <span class="level-badge level-hard">–°–ª–æ–∂–Ω–æ</span>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="soundEnabled" checked onchange="updateSettings()">
                        <label for="soundEnabled">–ó–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã</label>
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <h3>üìä –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π</h3>
                <div class="slider-container">
                    <span style="min-width: 80px;">–¶–≤–µ—Ç–∞</span>
                    <input type="range" class="slider" id="ratioSlider" min="50" max="90" value="70" step="10">
                    <span class="slider-value" id="ratioValue">70%</span>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div id="statsSection" class="card hidden">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∏–≥—Ä</h3>
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalSessions">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalTime">0</div>
                    <div class="stat-label">–ú–∏–Ω—É—Ç —Å—ã–≥—Ä–∞–Ω–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalTasks">0</div>
                    <div class="stat-label">–ó–∞–¥–∞–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                </div>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn-reset" onclick="resetAllStats()">üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="card">
            <!-- –ü–æ–ª–µ –¥–ª—è —Ü–µ–ª–∏ -->
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #1a202c;">
                    üéØ –ú–æ—è —Ü–µ–ª—å –¥–ª—è –±–µ—Å—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–≥–æ:
                </label>
                <textarea 
                    id="goalInput" 
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –Ø —Ö–æ—á—É –ª–µ–≥–∫–æ –∏ —Å —Ä–∞–¥–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç X. –Ø –≤–∏–∂—É —Å–µ–±—è —É–≤–µ—Ä–µ–Ω–Ω—ã–º –∏ —Å–ø–æ–∫–æ–π–Ω—ã–º –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏..."
                    style="width: 100%; min-height: 100px; padding: 15px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 16px; font-family: inherit; resize: vertical;"
                ></textarea>
                <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 14px; color: #6b7280;">
                    <span>üí° –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —è—Ä–∫–æ –∏ —Å–µ–Ω—Å–æ—Ä–Ω–æ</span>
                    <button 
                        onclick="clearGoal()" 
                        style="background: none; border: none; color: #ef4444; cursor: pointer; padding: 0; font-size: 14px;"
                    >üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="timer" id="timer">10:00</div>
                    <div class="stat-label">–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="taskCounter">0</div>
                    <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                </div>
            </div>

            <div class="button-group" style="justify-content: center; margin-top: 20px;">
                <button class="btn-start" id="startButton" onclick="startGame()">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>
                <button class="btn-pause hidden" id="pauseButton" onclick="pauseGame()">‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                <button class="btn-reset" id="resetButton" onclick="resetGame()">üîÑ –ó–∞–Ω–æ–≤–æ</button>
            </div>
        </div>

        <div class="card">
            <div class="game-area" id="gameArea">
                <div style="text-align: center; color: #718096;">
                    <h2 style="font-size: 32px; margin-bottom: 20px;">üéØ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?</h2>
                    <p style="font-size: 18px; line-height: 1.6;">
                        1. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ —Ü–µ–ª—å –¥–ª—è –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏—è<br>
                        2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã (‚öôÔ∏è)<br>
                        3. –ù–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ä—Ç" –∏ –≤—Ö–æ–¥–∏—Ç–µ –≤ —Ç—Ä–∞–Ω—Å!
                    </p>
                </div>
            </div>
        </div>

        <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã -->
        <div id="completeSection" class="card hidden">
            <div class="session-complete">
                <h2>üéâ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
                <p style="font-size: 18px; color: #718096; margin-bottom: 20px;">
                    –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢–µ–ø–µ—Ä—å –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Å–≤–æ–µ–π —Ü–µ–ª–∏ –∏ –ø—Ä–æ–∂–∏–≤–∏—Ç–µ –µ—ë –µ—â—ë —Ä–∞–∑.
                </p>
                
                <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–ª—å -->
                <div id="goalReminder" style="background: #f9fafb; padding: 20px; border-radius: 12px; margin: 20px 0; border-left: 4px solid #667eea;">
                    <div style="font-weight: 600; color: #667eea; margin-bottom: 10px;">üéØ –í–∞—à–∞ —Ü–µ–ª—å:</div>
                    <div id="goalReminderText" style="color: #1a202c; line-height: 1.6;"></div>
                </div>
                
                <div class="session-stats">
                    <div class="session-stat">
                        <span class="emoji">‚è±Ô∏è</span>
                        <span><strong id="completeDuration">0</strong> –º–∏–Ω—É—Ç</span>
                    </div>
                    <div class="session-stat">
                        <span class="emoji">‚úÖ</span>
                        <span><strong id="completeTasks">0</strong> –∑–∞–¥–∞–Ω–∏–π</span>
                    </div>
                    <div class="session-stat">
                        <span class="emoji">‚ö°</span>
                        <span><strong id="completeSpeed">0</strong> —Å–µ–∫/–∑–∞–¥–∞–Ω–∏–µ</span>
                    </div>
                </div>
                <div style="margin-top: 30px;">
                    <button class="btn-start" onclick="startNewSession()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤
        const colorNames = [
            '–ö—Ä–∞—Å–Ω—ã–π', '–û—Ä–∞–Ω–∂–µ–≤—ã–π', '–ñ—ë–ª—Ç—ã–π', '–ó–µ–ª—ë–Ω—ã–π', 
            '–ì–æ–ª—É–±–æ–π', '–°–∏–Ω–∏–π', '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π'
        ];

        const extraColorNames = [
            '–†–æ–∑–æ–≤—ã–π', '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π', '–°–µ—Ä—ã–π'
        ];

        const colorCodes = {
            '–ö—Ä–∞—Å–Ω—ã–π': '#ff0000',
            '–û—Ä–∞–Ω–∂–µ–≤—ã–π': '#ff8800',
            '–ñ—ë–ª—Ç—ã–π': '#ffff00',
            '–ó–µ–ª—ë–Ω—ã–π': '#00ff00',
            '–ì–æ–ª—É–±–æ–π': '#00ffff',
            '–°–∏–Ω–∏–π': '#0000ff',
            '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π': '#8800ff',
            '–†–æ–∑–æ–≤—ã–π': '#ff69b4',
            '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π': '#8b4513',
            '–°–µ—Ä—ã–π': '#808080'
        };

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã
        let settings = {
            duration: 10,
            speed: 1500,
            enableActions: true,
            actionClaps: true,
            actionJumps: true,
            actionAll: false,
            randomPosition: true,
            randomSize: true,
            extraColors: false,
            soundEnabled: true,
            colorRatio: 70
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            isPlaying: false,
            isPaused: false,
            timeLeft: 0,
            taskCount: 0,
            startTime: null,
            timerInterval: null,
            taskInterval: null,
            isShowingTask: false // –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
        };

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        let stats = JSON.parse(localStorage.getItem('rainbowGameStats')) || {
            totalSessions: 0,
            totalTime: 0,
            totalTasks: 0
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            loadGoal();
            updateStatsDisplay();
            updateSettingsUI();
        });

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–ª—å—é
        function loadGoal() {
            const saved = localStorage.getItem('rainbowGameGoal');
            if (saved) {
                document.getElementById('goalInput').value = saved;
            }
        }

        function saveGoal() {
            const goal = document.getElementById('goalInput').value;
            localStorage.setItem('rainbowGameGoal', goal);
        }

        function clearGoal() {
            document.getElementById('goalInput').value = '';
            localStorage.removeItem('rainbowGameGoal');
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
        document.getElementById('goalInput').addEventListener('input', saveGoal);

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        function loadSettings() {
            const saved = localStorage.getItem('rainbowGameSettings');
            if (saved) {
                settings = { ...settings, ...JSON.parse(saved) };
            }
            updateSettingsUI();
        }

        function saveSettings() {
            localStorage.setItem('rainbowGameSettings', JSON.stringify(settings));
        }

        function updateSettings() {
            settings.enableActions = document.getElementById('enableActions').checked;
            settings.actionClaps = document.getElementById('actionClaps').checked;
            settings.actionJumps = document.getElementById('actionJumps').checked;
            settings.actionAll = document.getElementById('actionAll').checked;
            settings.randomPosition = document.getElementById('randomPosition').checked;
            settings.randomSize = document.getElementById('randomSize').checked;
            settings.extraColors = document.getElementById('extraColors').checked;
            settings.soundEnabled = document.getElementById('soundEnabled').checked;
            saveSettings();
        }

        function updateSettingsUI() {
            document.getElementById('durationSlider').value = settings.duration;
            document.getElementById('durationValue').textContent = settings.duration + ' –º–∏–Ω';
            document.getElementById('speedSlider').value = settings.speed;
            document.getElementById('speedValue').textContent = (settings.speed / 1000).toFixed(1) + ' —Å–µ–∫';
            document.getElementById('ratioSlider').value = settings.colorRatio;
            document.getElementById('ratioValue').textContent = settings.colorRatio + '%';
            document.getElementById('enableActions').checked = settings.enableActions;
            document.getElementById('actionClaps').checked = settings.actionClaps;
            document.getElementById('actionJumps').checked = settings.actionJumps;
            document.getElementById('actionAll').checked = settings.actionAll;
            document.getElementById('randomPosition').checked = settings.randomPosition;
            document.getElementById('randomSize').checked = settings.randomSize;
            document.getElementById('extraColors').checked = settings.extraColors;
            document.getElementById('soundEnabled').checked = settings.soundEnabled;
        }

        // –°–ª–∞–π–¥–µ—Ä—ã
        document.getElementById('durationSlider').addEventListener('input', function(e) {
            settings.duration = parseInt(e.target.value);
            document.getElementById('durationValue').textContent = settings.duration + ' –º–∏–Ω';
            saveSettings();
        });

        document.getElementById('speedSlider').addEventListener('input', function(e) {
            settings.speed = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = (settings.speed / 1000).toFixed(1) + ' —Å–µ–∫';
            saveSettings();
            if (gameState.isPlaying && !gameState.isPaused) {
                restartTaskInterval();
            }
        });

        document.getElementById('ratioSlider').addEventListener('input', function(e) {
            settings.colorRatio = parseInt(e.target.value);
            document.getElementById('ratioValue').textContent = settings.colorRatio + '%';
            saveSettings();
        });

        function setDuration(minutes) {
            settings.duration = minutes;
            document.getElementById('durationSlider').value = minutes;
            document.getElementById('durationValue').textContent = minutes + ' –º–∏–Ω';
            saveSettings();
            document.querySelectorAll('.speed-presets button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function setSpeed(ms) {
            settings.speed = ms;
            document.getElementById('speedSlider').value = ms;
            document.getElementById('speedValue').textContent = (ms / 1000).toFixed(1) + ' —Å–µ–∫';
            saveSettings();
            if (gameState.isPlaying && !gameState.isPaused) {
                restartTaskInterval();
            }
            event.target.parentElement.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
        function toggleInfo() {
            const section = document.getElementById('infoSection');
            section.classList.toggle('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
            document.getElementById('statsSection').classList.add('hidden');
        }

        function toggleSettings() {
            const section = document.getElementById('settingsSection');
            section.classList.toggle('hidden');
            document.getElementById('infoSection').classList.add('hidden');
            document.getElementById('statsSection').classList.add('hidden');
        }

        function toggleStats() {
            const section = document.getElementById('statsSection');
            section.classList.toggle('hidden');
            document.getElementById('infoSection').classList.add('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
        }

        // –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
        function startGame() {
            if (gameState.isPlaying) return;

            gameState.isPlaying = true;
            gameState.isPaused = false;
            gameState.timeLeft = settings.duration * 60;
            gameState.taskCount = 0;
            gameState.startTime = Date.now();
            gameState.isShowingTask = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥

            document.getElementById('startButton').classList.add('hidden');
            document.getElementById('pauseButton').classList.remove('hidden');
            document.getElementById('completeSection').classList.add('hidden');

            updateTimer();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            gameState.timerInterval = setInterval(updateTimer, 1000);
            
            // –¢–û–õ–¨–ö–û setInterval, –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤!
            // –ü–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ –ø–æ—è–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ settings.speed –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
            gameState.taskInterval = setInterval(showNextTask, settings.speed);
        }

        function pauseGame() {
            if (!gameState.isPlaying || gameState.isPaused) return;

            gameState.isPaused = true;
            clearInterval(gameState.timerInterval);
            clearInterval(gameState.taskInterval);

            document.getElementById('pauseButton').innerHTML = '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            document.getElementById('gameArea').innerHTML = '<div style="text-align: center; color: white; font-size: 32px;">‚è∏Ô∏è –ü–ê–£–ó–ê</div>';
        }

        function resumeGame() {
            if (!gameState.isPlaying || !gameState.isPaused) return;

            gameState.isPaused = false;
            document.getElementById('pauseButton').innerHTML = '‚è∏Ô∏è –ü–∞—É–∑–∞';

            // –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–¥–∞–Ω–∏–µ —Å—Ä–∞–∑—É, –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∞–º –ø–æ–∫–∞–∂–µ—Ç
            gameState.timerInterval = setInterval(updateTimer, 1000);
            gameState.taskInterval = setInterval(showNextTask, settings.speed);
        }

        function resetGame() {
            gameState.isPlaying = false;
            gameState.isPaused = false;
            clearInterval(gameState.timerInterval);
            clearInterval(gameState.taskInterval);

            gameState.timeLeft = settings.duration * 60;
            gameState.taskCount = 0;

            document.getElementById('startButton').classList.remove('hidden');
            document.getElementById('pauseButton').classList.add('hidden');
            document.getElementById('pauseButton').innerHTML = '‚è∏Ô∏è –ü–∞—É–∑–∞';
            
            updateTimer();
            document.getElementById('taskCounter').textContent = '0';
            document.getElementById('gameArea').innerHTML = `
                <div style="text-align: center; color: #718096;">
                    <h2 style="font-size: 32px; margin-bottom: 20px;">üéØ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?</h2>
                    <p style="font-size: 18px; line-height: 1.6;">
                        1. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ —Ü–µ–ª—å –¥–ª—è –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏—è<br>
                        2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã (‚öôÔ∏è)<br>
                        3. –ù–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ä—Ç" –∏ –≤—Ö–æ–¥–∏—Ç–µ –≤ —Ç—Ä–∞–Ω—Å!
                    </p>
                </div>
            `;
        }

        function updateTimer() {
            if (gameState.isPaused) return;

            gameState.timeLeft--;

            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            const timeDisplay = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('timer').textContent = timeDisplay;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–∫–∂–µ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            const fullscreenTimer = document.getElementById('fullscreenTimer');
            if (fullscreenTimer) {
                fullscreenTimer.textContent = timeDisplay;
            }

            if (gameState.timeLeft <= 0) {
                endGame();
            }
        }

        function endGame() {
            gameState.isPlaying = false;
            clearInterval(gameState.timerInterval);
            clearInterval(gameState.taskInterval);

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const duration = Math.round((Date.now() - gameState.startTime) / 60000);
            stats.totalSessions++;
            stats.totalTime += duration;
            stats.totalTasks += gameState.taskCount;
            localStorage.setItem('rainbowGameStats', JSON.stringify(stats));
            updateStatsDisplay();

            // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('completeDuration').textContent = duration;
            document.getElementById('completeTasks').textContent = gameState.taskCount;
            document.getElementById('completeSpeed').textContent = 
                gameState.taskCount > 0 ? (duration * 60 / gameState.taskCount).toFixed(1) : '0';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–ª—å
            const goal = document.getElementById('goalInput').value.trim();
            const goalReminder = document.getElementById('goalReminder');
            const goalReminderText = document.getElementById('goalReminderText');
            
            if (goal) {
                goalReminderText.textContent = goal;
                goalReminder.style.display = 'block';
            } else {
                goalReminder.style.display = 'none';
            }
            
            document.getElementById('completeSection').classList.remove('hidden');

            // –ó–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            if (settings.soundEnabled) {
                playCompletionSound();
            }

            // –°–∫—Ä—ã—Ç–∏–µ –∫–Ω–æ–ø–æ–∫
            document.getElementById('pauseButton').classList.add('hidden');
            document.getElementById('startButton').classList.remove('hidden');
        }

        function restartTaskInterval() {
            clearInterval(gameState.taskInterval);
            // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–æ–≤–æ —Å—Ä–∞–∑—É - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ–∫–∞–∂–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ settings.speed
            gameState.taskInterval = setInterval(showNextTask, settings.speed);
        }

        function showNextTask() {
            if (gameState.isPaused) return;
            
            // –ó–ê–©–ò–¢–ê: –ï—Å–ª–∏ —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–¥–∞–Ω–∏–µ, –≤—ã—Ö–æ–¥–∏–º
            if (gameState.isShowingTask) {
                console.log('‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞!');
                return;
            }
            
            gameState.isShowingTask = true;

            gameState.taskCount++;
            document.getElementById('taskCounter').textContent = gameState.taskCount;

            const isAction = settings.enableActions && Math.random() * 100 > settings.colorRatio;

            if (isAction) {
                showAction();
            } else {
                showColorTask();
            }
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ 50–º—Å (–∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–ª–∏—Ç—Å—è 300–º—Å –ø–æ CSS)
            setTimeout(() => {
                gameState.isShowingTask = false;
            }, 50);
        }

        function showColorTask() {
            const colors = settings.extraColors 
                ? [...colorNames, ...extraColorNames]
                : colorNames;

            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–æ –∏ —Ü–≤–µ—Ç (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏!)
            let word = colors[Math.floor(Math.random() * colors.length)];
            let colorName = colors[Math.floor(Math.random() * colors.length)];
            
            // –ö–†–ò–¢–ò–ß–ù–û: —Ü–≤–µ—Ç –∏ —Å–ª–æ–≤–æ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å
            while (word === colorName) {
                colorName = colors[Math.floor(Math.random() * colors.length)];
            }

            const color = colorCodes[colorName];
            const position = settings.randomPosition ? getRandomPosition() : { top: '50%', left: '50%' };
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (–æ—Ç 60px –¥–æ 120px)
            const fontSize = settings.randomSize 
                ? Math.floor(Math.random() * 61) + 60  // 60-120px
                : 120;

            document.getElementById('gameArea').innerHTML = `
                <div class="word-display" style="color: ${color}; font-size: ${fontSize}px; top: ${position.top}; left: ${position.left}; transform: translate(-50%, -50%);">
                    ${word}
                </div>
            `;
            
            // –í–ê–ñ–ù–û: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë–º —Ç–∞–π–º–µ—Ä –ø–æ—Å–ª–µ innerHTML (–µ—Å–ª–∏ –≤ fullscreen)
            if (document.fullscreenElement || document.webkitFullscreenElement) {
                const minutes = Math.floor(gameState.timeLeft / 60);
                const seconds = gameState.timeLeft % 60;
                const timerHtml = `<div class="fullscreen-timer visible" id="fullscreenTimer">${minutes}:${seconds.toString().padStart(2, '0')}</div>`;
                document.getElementById('gameArea').insertAdjacentHTML('afterbegin', timerHtml);
            }
        }

        function showAction() {
            const actions = [];
            if (settings.actionClaps) actions.push('–•–õ–û–ü–ö–ò');
            if (settings.actionJumps) actions.push('–ü–†–´–ñ–ö–ò');
            if (settings.actionAll) actions.push('–í–°–Å –í–ú–ï–°–¢–ï');

            if (actions.length === 0) {
                showColorTask();
                return;
            }

            const action = actions[Math.floor(Math.random() * actions.length)];
            const position = settings.randomPosition ? getRandomPosition() : { top: '50%', left: '50%' };

            document.getElementById('gameArea').innerHTML = `
                <div class="action-display" style="top: ${position.top}; left: ${position.left}; transform: translate(-50%, -50%);">
                    ${action}
                </div>
            `;
            
            // –í–ê–ñ–ù–û: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë–º —Ç–∞–π–º–µ—Ä –ø–æ—Å–ª–µ innerHTML (–µ—Å–ª–∏ –≤ fullscreen)
            if (document.fullscreenElement || document.webkitFullscreenElement) {
                const minutes = Math.floor(gameState.timeLeft / 60);
                const seconds = gameState.timeLeft % 60;
                const timerHtml = `<div class="fullscreen-timer visible" id="fullscreenTimer">${minutes}:${seconds.toString().padStart(2, '0')}</div>`;
                document.getElementById('gameArea').insertAdjacentHTML('afterbegin', timerHtml);
            }
        }

        function getRandomPosition() {
            const positions = [
                { top: '30%', left: '30%' },
                { top: '30%', left: '50%' },
                { top: '30%', left: '70%' },
                { top: '50%', left: '30%' },
                { top: '50%', left: '50%' },
                { top: '50%', left: '70%' },
                { top: '70%', left: '30%' },
                { top: '70%', left: '50%' },
                { top: '70%', left: '70%' }
            ];
            return positions[Math.floor(Math.random() * positions.length)];
        }

        function startNewSession() {
            document.getElementById('completeSection').classList.add('hidden');
            resetGame();
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        function updateStatsDisplay() {
            document.getElementById('totalSessions').textContent = stats.totalSessions;
            document.getElementById('totalTime').textContent = stats.totalTime;
            document.getElementById('totalTasks').textContent = stats.totalTasks;
        }

        function resetAllStats() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                stats = {
                    totalSessions: 0,
                    totalTime: 0,
                    totalTasks: 0
                };
                localStorage.setItem('rainbowGameStats', JSON.stringify(stats));
                updateStatsDisplay();
            }
        }

        // –ó–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        function playCompletionSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = 523.25; // –î–æ
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);

            setTimeout(() => {
                const osc2 = audioContext.createOscillator();
                const gain2 = audioContext.createGain();
                osc2.connect(gain2);
                gain2.connect(audioContext.destination);
                osc2.frequency.value = 659.25; // –ú–∏
                osc2.type = 'sine';
                gain2.gain.setValueAtTime(0.3, audioContext.currentTime);
                gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                osc2.start(audioContext.currentTime);
                osc2.stop(audioContext.currentTime + 0.5);
            }, 200);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –ø–∞—É–∑—ã
        document.getElementById('pauseButton').addEventListener('click', function() {
            if (gameState.isPaused) {
                resumeGame();
            } else {
                pauseGame();
            }
        });

        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        document.addEventListener('keydown', function(e) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ –ª–∏ –º—ã —Å–µ–π—á–∞—Å
            const activeElement = document.activeElement;
            const isTyping = activeElement.tagName === 'TEXTAREA' || 
                            activeElement.tagName === 'INPUT' ||
                            activeElement.isContentEditable;
            
            // –ï—Å–ª–∏ –ø–µ—á–∞—Ç–∞–µ–º —Ç–µ–∫—Å—Ç - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
            if (isTyping) {
                return;
            }
            
            if (e.code === 'Space' && !gameState.isPlaying) {
                e.preventDefault();
                startGame();
            } else if (e.code === 'Space' && gameState.isPlaying) {
                e.preventDefault();
                if (gameState.isPaused) {
                    resumeGame();
                } else {
                    pauseGame();
                }
            } else if (e.code === 'Escape') {
                // –ï—Å–ª–∏ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ - –≤—ã—Ö–æ–¥–∏–º
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    resetGame();
                }
            } else if (e.code === 'KeyF' && !gameState.isPlaying) {
                // F = Fullscreen (—Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –Ω–µ –∏–¥—ë—Ç)
                e.preventDefault();
                toggleFullscreen();
            }
        });

        // –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
        function toggleFullscreen() {
            const gameArea = document.getElementById('gameArea');
            
            if (!document.fullscreenElement) {
                // –í—Ö–æ–¥–∏–º –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                if (gameArea.requestFullscreen) {
                    gameArea.requestFullscreen();
                } else if (gameArea.webkitRequestFullscreen) {
                    gameArea.webkitRequestFullscreen(); // Safari
                } else if (gameArea.msRequestFullscreen) {
                    gameArea.msRequestFullscreen(); // IE11
                }
            } else {
                // –í—ã—Ö–æ–¥–∏–º –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen(); // Safari
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen(); // IE11
                }
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ/–≤—ã—Ö–æ–¥–µ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        document.addEventListener('fullscreenchange', updateFullscreenButton);
        document.addEventListener('webkitfullscreenchange', updateFullscreenButton); // Safari

        function updateFullscreenButton() {
            const btn = document.getElementById('fullscreenBtn');
            const gameArea = document.getElementById('gameArea');
            
            if (document.fullscreenElement || document.webkitFullscreenElement) {
                // –í—Ö–æ–¥–∏–º –≤ fullscreen
                if (btn) {
                    btn.textContent = '‚õ∂';
                    btn.title = '–í—ã–π—Ç–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (Esc)';
                }
                
                // –°–æ–∑–¥–∞—ë–º —Ç–∞–π–º–µ—Ä –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç
                if (!document.getElementById('fullscreenTimer')) {
                    const timer = document.createElement('div');
                    timer.id = 'fullscreenTimer';
                    timer.className = 'fullscreen-timer visible';
                    
                    const minutes = Math.floor(gameState.timeLeft / 60);
                    const seconds = gameState.timeLeft % 60;
                    timer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    
                    gameArea.appendChild(timer);
                }
            } else {
                // –í—ã—Ö–æ–¥–∏–º –∏–∑ fullscreen
                if (btn) {
                    btn.textContent = '‚õ∂';
                    btn.title = '–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º (F)';
                }
                
                // –£–¥–∞–ª—è–µ–º —Ç–∞–π–º–µ—Ä
                const timer = document.getElementById('fullscreenTimer');
                if (timer) {
                    timer.remove();
                }
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                tg.ready();
                tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
                document.body.classList.add('telegram-app');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –≤ Telegram
                tg.BackButton.show();
                tg.BackButton.onClick(() => {
                    if (gameState.isPlaying) {
                        if (confirm('–ò–≥—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                            tg.close();
                        }
                    } else {
                        tg.close();
                    }
                });
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É Telegram –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
                if (tg.themeParams.bg_color) {
                    document.body.style.background = tg.themeParams.bg_color;
                }
                
                console.log('‚úÖ Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (–†–∞–¥—É–≥–∞)');
            }
        });
    </script>
</body>
</html>